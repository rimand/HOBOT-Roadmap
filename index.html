<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOBOT Roadmap 2024-2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Anuphan:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Anuphan', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        .stagger-1 { animation-delay: 0.05s; }
        .stagger-2 { animation-delay: 0.1s; }
        .stagger-3 { animation-delay: 0.15s; }
        .stagger-4 { animation-delay: 0.2s; }
        
        @media print {
            .no-print { display: none !important; }
            body { background: white; }
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Password Protection Component
        const PasswordProtection = ({ onSuccess }) => {
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [correctPasswordHash, setCorrectPasswordHash] = useState(null);
            
            // คำนวณ hash เมื่อ component mount - ไม่แสดง plain password ในโค้ด
            useEffect(() => {
                // ใช้วิธี obfuscate ที่ซับซ้อน - ใช้ mathematical operations และ multiple encoding layers
                // ใช้ตัวเลขและ operations เพื่อสร้าง password string โดยไม่แสดง plain text
                // วิธีนี้ทำให้ยากต่อการ reverse engineer
                const seed = 104; // base value
                const operations = [
                    seed + 0,      
                    seed + 4,      
                    seed - 7,      
                    seed - 6,      
                    seed - 55,     
                    seed - 54,     
                    seed - 53,     
                    seed - 52     
                ];
                
                // Reconstruct password from operations
                const passArray = operations.map(op => String.fromCharCode(op));
                const passString = passArray.join('');
                
                // Hash password
                const hash = CryptoJS.SHA256(passString).toString();
                setCorrectPasswordHash(hash);
            }, []);
            
            // ตรวจสอบ session
            useEffect(() => {
                const session = localStorage.getItem('hobot_session');
                if (session) {
                    // ตรวจสอบว่า session ยังไม่หมดอายุ (24 ชั่วโมง)
                    const sessionData = JSON.parse(session);
                    const now = Date.now();
                    if (sessionData.expiry > now) {
                        onSuccess();
                        return;
                    } else {
                        localStorage.removeItem('hobot_session');
                    }
                }
            }, [onSuccess]);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setIsLoading(true);
                
                // ตรวจสอบว่า hash พร้อมแล้ว
                if (!correctPasswordHash) {
                    setIsLoading(false);
                    return;
                }
                
                // ใช้ setTimeout เพื่อป้องกัน timing attack
                setTimeout(() => {
                    // Hash password ที่กรอกด้วย SHA-256
                    const inputHash = CryptoJS.SHA256(password).toString();
                    
                    // เปรียบเทียบ hash (ใช้ constant-time comparison)
                    let isValid = true;
                    if (inputHash.length !== correctPasswordHash.length) {
                        isValid = false;
                    } else {
                        for (let i = 0; i < inputHash.length; i++) {
                            if (inputHash[i] !== correctPasswordHash[i]) {
                                isValid = false;
                                break;
                            }
                        }
                    }
                    
                    if (isValid) {
                        // เก็บ session (24 ชั่วโมง)
                        const sessionData = {
                            authenticated: true,
                            expiry: Date.now() + (24 * 60 * 60 * 1000)
                        };
                        localStorage.setItem('hobot_session', JSON.stringify(sessionData));
                        onSuccess();
                    } else {
                        setError('รหัสผ่านไม่ถูกต้อง');
                        setPassword('');
                    }
                    setIsLoading(false);
                }, 300);
            };
            
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full">
                        <div className="text-center mb-6">
                            <div className="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <Icons.Cpu className="text-white" />
                            </div>
                            <h1 className="text-2xl font-bold text-slate-800 mb-2">HOBOT Roadmap</h1>
                            <p className="text-slate-600 text-sm">กรุณากรอกรหัสผ่านเพื่อเข้าถึง</p>
                        </div>
                        
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-slate-700 mb-2">
                                    รหัสผ่าน
                                </label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                                    placeholder="กรอกรหัสผ่าน"
                                    autoFocus
                                    disabled={isLoading}
                                />
                            </div>
                            
                            {error && (
                                <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm flex items-center gap-2">
                                    <Icons.Alert className="text-red-600" />
                                    {error}
                                </div>
                            )}
                            
                            <button
                                type="submit"
                                disabled={isLoading || !password}
                                className="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed text-white font-semibold py-3 rounded-lg transition-all"
                            >
                                {isLoading ? 'กำลังตรวจสอบ...' : 'เข้าสู่ระบบ'}
                            </button>
                        </form>
                        
                        <div className="mt-6 text-center">
                            <p className="text-xs text-slate-500">
                                รหัสผ่านจะถูกเข้ารหัสและไม่ถูกเก็บในรูปแบบ plain text
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // SVG Icons
        const Icons = {
            Cpu: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="16" x="4" y="4" rx="2"/><rect width="6" height="6" x="9" y="9" rx="1"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></svg>,
            Zap: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m13 2-2 10h8L7 22l2-10H1L13 2z"/></svg>,
            Calendar: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Settings: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            History: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>,
            Truck: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10 17h4"/><path d="M14 17h5"/><path d="M19 17h1a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3"/><path d="M20 14h2"/><path d="M3 9h13v8H3z"/><path d="M3 17h4"/><circle cx="9" cy="17" r="2"/><circle cx="18" cy="17" r="2"/></svg>,
            Target: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
            Box: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>,
            Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            Alert: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>,
            Search: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
            Filter: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            ChevronDown: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 12 15 18 9"/></svg>,
            ChevronUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="18 15 12 9 6 15"/></svg>,
            ArrowUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>,
            Info: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>,
            TrendingUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
            BarChart: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" x2="12" y1="20" y2="10"/><line x1="18" x2="18" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="16"/></svg>
        };

        // Tooltip Component
        const Tooltip = ({ children, content }) => {
            const [show, setShow] = useState(false);
            return (
                <span className="relative inline-block">
                    <span 
                        onMouseEnter={() => setShow(true)}
                        onMouseLeave={() => setShow(false)}
                        className="cursor-help inline-flex items-center gap-1 text-blue-600 hover:text-blue-700"
                    >
                        {children}
                        <Icons.Info />
                    </span>
                    {show && (
                        <div className="absolute z-50 bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-slate-900 text-white text-xs rounded-lg shadow-lg max-w-xs whitespace-normal">
                            {content}
                            <div className="absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-slate-900"></div>
                        </div>
                    )}
                </span>
            );
        };

        // Scroll to Top Button
        const ScrollToTop = () => {
            const [visible, setVisible] = useState(false);
            
            useEffect(() => {
                const toggleVisibility = () => {
                    setVisible(window.pageYOffset > 300);
                };
                window.addEventListener('scroll', toggleVisibility);
                return () => window.removeEventListener('scroll', toggleVisibility);
            }, []);
            
            const scrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            
            if (!visible) return null;
            
            return (
                <button
                    onClick={scrollToTop}
                    className="fixed bottom-8 right-8 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg transition-all hover:scale-110 z-40 no-print"
                    aria-label="Scroll to top"
                >
                    <Icons.ArrowUp />
                </button>
            );
        };

        const App = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [activeYear, setActiveYear] = useState(2025);
            const [searchQuery, setSearchQuery] = useState('');
            const [selectedProducts, setSelectedProducts] = useState([]);
            const [selectedTypes, setSelectedTypes] = useState([]);
            const [expandedItems, setExpandedItems] = useState(new Set());
            const [showFilters, setShowFilters] = useState(false);
            const [fadeKey, setFadeKey] = useState(0);

            const productStats = [
                { name: "Turntable", count: 6, icon: <Icons.History />, color: "bg-blue-500" },
                { name: "เครื่องดูดผ้า", count: 5, icon: <Icons.Zap />, color: "bg-purple-500" },
                { name: "RobotArm", count: 3, icon: <Icons.Cpu />, color: "bg-indigo-500" },
                { name: "LinearTrack", count: 3, icon: <Icons.Settings />, color: "bg-cyan-500" },
                { name: "treadmill", count: 3, icon: <Icons.Target />, color: "bg-emerald-500" },
                { name: "ล้อ Combide", count: 2, icon: <Icons.Settings />, color: "bg-orange-500" },
                { name: "Stage Mobile", count: 2, icon: <Icons.Truck />, color: "bg-red-500" },
                { name: "รางจอ", count: 2, icon: <Icons.Box />, color: "bg-slate-500" },
                { name: "จอแท่ง", count: 1, icon: <Icons.Box />, color: "bg-gray-400" },
            ];

            const timeline2024 = [
                { month: "ม.ค. - มี.ค.", event: "จุดเริ่มต้น HOBOT", detail: "วางแผนและเตรียมการเบื้องต้นเพื่อก่อตั้งทีม", type: "milestone", jobs: ["Project Initiation"] },
                { month: "เม.ย.", event: "เริ่มฟอร์มทีมงาน", detail: "เริ่มทีมงานหลัก (Include - เบส)", type: "team", jobs: ["Team Building"] },
                { month: "พ.ค.", event: "งาน Kingdom", detail: "ออกงาน Robotarm + พัฒนา LinearTrack v1", type: "event", tags: ["Robotarm", "LinearTrack v1"], jobs: ["งาน Kingdom"] },
                { month: "มิ.ย.", event: "งาน Mis", detail: "ขยายพื้นที่โกดังบางบัวทอง และเช่า AGV ออกงาน", type: "event", tags: ["AGV"], jobs: ["งาน Mis (AGV)"] },
                { month: "ก.ค.", event: "R&D Turntable ครั้งแรก", detail: "พัฒนา LinearTrack v2 และไปดูงานที่จีน", type: "tech", jobs: ["R&D Linear v2"] },
                { month: "ส.ค. - ก.ย.", event: "งาน นน & งานบ้าน PP", detail: "เริ่มนำ Turntable ออกงานครั้งแรกๆ", type: "event", tags: ["Turntable"], jobs: ["งาน นน", "งานบ้าน PP"] },
                { month: "พ.ย.", event: "RoboDK Realtime", detail: "เริ่มใช้ระบบ Realtime Robotarm และรางแบบกระโถง", type: "tech", jobs: ["RoboDK Setup"] },
                { month: "ธ.ค.", event: "งาน Whiteparty", detail: "Robotarm ออกงานใหญ่ส่งท้ายปี", type: "event", tags: ["Robotarm"], jobs: ["งาน Whiteparty"] },
            ];

            const timeline2025 = [
                { month: "ม.ค.", event: "งาน Samsung", detail: "R&D Robot/Display (มีบทเรียน Robot ตก)", type: "event", tags: ["Robotarm", "Display"], jobs: ["งาน Samsung"] },
                { month: "ก.พ.", event: "ย้ายโกดังแจ้งวัฒนะ", detail: "สร้าง treadmill (Pulse Control)", type: "milestone", jobs: ["Warehouse Moving"] },
                { month: "มี.ค.", event: "งาน PP", detail: "ออกงานลู่วิ่ง", type: "event", tags: ["treadmill"], jobs: ["งาน PP (ลู่วิ่ง)"] },
                { month: "เม.ย.", event: "งาน Ten101 & EtherCAT", detail: "เริ่มใช้ระบบ EtherCAT และนำเข้า Gear 30:1", type: "tech", tags: ["treadmill"], jobs: ["งาน Ten101"] },
                { month: "พ.ค.", event: "งาน Jeff", detail: "ใช้ Turn ใหญ่-เล็ก, สร้างรางเคลื่อนที่เล็ก, ทำตู้ Control", type: "event", tags: ["Turntable", "EtherCAT"], jobs: ["งาน Jeff (Turn ใหญ่/เล็ก)"] },
                { month: "มิ.ย.", event: "งาน MUT", detail: "สร้างล้อ Combide ครั้งแรก และ Robotarm ออกงาน", type: "event", tags: ["Robotarm", "ล้อ Combide"], jobs: ["งาน MUT"] },
                { month: "ก.ค.", event: "Robot Sync Success", detail: "สร้างมอเตอร์ไซค์ HOBOT และ Sync จอได้สำเร็จครั้งแรก", type: "success", tags: ["Robot Sync", "Display"], jobs: ["HOBOT Motorcycle"] },
                { month: "ส.ค.", event: "งาน Nimitr & Asia7", detail: "สร้างจอแท่ง และเครื่องดูดผ้าครั้งแรก", type: "success", tags: ["Turntable", "เครื่องดูดผ้า", "จอแท่ง"], jobs: ["งาน Nimitr", "งาน Asia7"] },
                { month: "ก.ย.", event: "งาน Nont & งาน Mirr", detail: "เครื่องดูดผ้า และ Stage Mobile + Turn ออกงาน", type: "event", tags: ["เครื่องดูดผ้า", "Stage Mobile", "Turntable"], jobs: ["งาน Nont", "งาน Mirr"] },
                { month: "ต.ค.", event: "Peak Workload", detail: "เดือนที่งานหนาแน่นที่สุดของปี", type: "event", tags: ["เครื่องดูดผ้า (3)", "Turntable", "Robotarm", "treadmill"], jobs: ["งาน Pun", "งาน ขีดลม", "งาน Tatto Color", "งาน Da", "งาน Dark"] },
                { month: "พ.ย.", event: "งาน HILUX & งาน BUS", detail: "งานเครื่องดูดผ้า และงาน BUS (บันทึกว่าไม่สำเร็จ)", type: "event", tags: ["เครื่องดูดผ้า", "Stage Mobile (Failed)"], jobs: ["งาน HILUX", "งาน BUS (Failed)"] },
                { month: "ธ.ค.", event: "สร้างรางจอครั้งแรก", detail: "พัฒนา Product รางจอเพื่อขยายศักยภาพปีหน้า", type: "tech", tags: ["รางจอ"], jobs: ["R&D รางจอ"] },
            ];

            // Handle year change with animation
            const handleYearChange = (year) => {
                if (year !== activeYear) {
                    setFadeKey(prev => prev + 1);
                    setTimeout(() => setActiveYear(year), 200);
                }
            };

            // Get all unique products and types
            const allProducts = useMemo(() => {
                const products = new Set();
                const currentTimeline = activeYear === 2024 ? timeline2024 : timeline2025;
                currentTimeline.forEach(item => {
                    if (item.tags) {
                        item.tags.forEach(tag => {
                            // Extract product names from tags
                            const productNames = ["Turntable", "Robotarm", "RobotArm", "LinearTrack", "treadmill", "ล้อ Combide", "Stage Mobile", "รางจอ", "จอแท่ง", "เครื่องดูดผ้า", "Display", "AGV", "EtherCAT", "Robot Sync"];
                            productNames.forEach(p => {
                                if (tag.includes(p)) products.add(p);
                            });
                        });
                    }
                });
                return Array.from(products).sort();
            }, [activeYear]);

            const allTypes = ['success', 'tech', 'event', 'milestone', 'team'];

            // Filter timeline
            const filteredTimeline = useMemo(() => {
                const currentTimeline = activeYear === 2024 ? timeline2024 : timeline2025;
                return currentTimeline.filter(item => {
                    // Search filter
                    if (searchQuery) {
                        const query = searchQuery.toLowerCase();
                        const matchesSearch = 
                            item.event.toLowerCase().includes(query) ||
                            item.detail.toLowerCase().includes(query) ||
                            (item.jobs && item.jobs.some(job => job.toLowerCase().includes(query))) ||
                            (item.tags && item.tags.some(tag => tag.toLowerCase().includes(query)));
                        if (!matchesSearch) return false;
                    }
                    
                    // Product filter
                    if (selectedProducts.length > 0) {
                        const hasProduct = item.tags && item.tags.some(tag => 
                            selectedProducts.some(prod => tag.includes(prod))
                        );
                        if (!hasProduct) return false;
                    }
                    
                    // Type filter
                    if (selectedTypes.length > 0) {
                        if (!selectedTypes.includes(item.type)) return false;
                    }
                    
                    return true;
                });
            }, [activeYear, searchQuery, selectedProducts, selectedTypes]);

            // Highlight search text
            const highlightText = (text, query) => {
                if (!query) return text;
                const parts = text.split(new RegExp(`(${query})`, 'gi'));
                return parts.map((part, i) => 
                    part.toLowerCase() === query.toLowerCase() ? 
                        <mark key={i} className="bg-yellow-200 px-1 rounded">{part}</mark> : part
                );
            };

            // Toggle expanded item
            const toggleExpanded = (index) => {
                setExpandedItems(prev => {
                    const newSet = new Set(prev);
                    if (newSet.has(index)) {
                        newSet.delete(index);
                    } else {
                        newSet.add(index);
                    }
                    return newSet;
                });
            };

            // Clear all filters
            const clearFilters = () => {
                setSearchQuery('');
                setSelectedProducts([]);
                setSelectedTypes([]);
            };

            const hasActiveFilters = searchQuery || selectedProducts.length > 0 || selectedTypes.length > 0;

            // Keyboard navigation
            useEffect(() => {
                const handleKeyPress = (e) => {
                    if (e.key === 'Escape') {
                        clearFilters();
                        setShowFilters(false);
                    }
                    if (e.key === 'ArrowUp' && e.ctrlKey) {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                };
                window.addEventListener('keydown', handleKeyPress);
                return () => window.removeEventListener('keydown', handleKeyPress);
            }, []);

            const currentTimeline = activeYear === 2024 ? timeline2024 : timeline2025;
            const workCount = activeYear === 2024 ? 5 : 17;

            // ถ้ายังไม่ authenticated แสดง password protection
            if (!isAuthenticated) {
                return <PasswordProtection onSuccess={() => setIsAuthenticated(true)} />;
            }

            return (
                <div className="min-h-screen pb-20">
                    <header className="bg-white border-b sticky top-0 z-50 shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-2">
                                <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white">
                                    <Icons.Cpu />
                                </div>
                                <span className="font-bold text-xl tracking-tight">HOBOT ROADMAP</span>
                            </div>
                            <div className="flex items-center gap-4">
                                <button
                                    onClick={() => setShowFilters(!showFilters)}
                                    className={`p-2 rounded-lg transition-all no-print ${showFilters ? 'bg-blue-100 text-blue-600' : 'text-slate-600 hover:bg-slate-100'}`}
                                    aria-label="Toggle filters"
                                >
                                    <Icons.Filter />
                                </button>
                                <div className="flex bg-slate-100 p-1 rounded-full">
                                    {[2024, 2025].map(year => (
                                        <button 
                                            key={year}
                                            onClick={() => handleYearChange(year)}
                                            className={`px-6 py-1.5 rounded-full text-sm font-medium transition-all ${activeYear === year ? 'bg-white shadow-sm text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                                        >
                                            {year}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 py-8">
                        {/* Search and Filters */}
                        <div className={`mb-6 space-y-4 no-print ${showFilters ? 'fade-in' : 'hidden'}`}>
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                <div className="flex flex-col md:flex-row gap-4">
                                    <div className="flex-1 relative">
                                        <Icons.Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400" />
                                        <input
                                            type="text"
                                            placeholder="ค้นหา events, jobs, หรือ tags..."
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                            className="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        />
                                    </div>
                                    {hasActiveFilters && (
                                        <button
                                            onClick={clearFilters}
                                            className="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-all flex items-center gap-2"
                                        >
                                            <Icons.X /> Clear Filters
                                        </button>
                                    )}
                                </div>
                                
                                {hasActiveFilters && (
                                    <div className="mt-4 flex flex-wrap gap-2">
                                        {searchQuery && (
                                            <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm flex items-center gap-2">
                                                Search: "{searchQuery}"
                                                <button onClick={() => setSearchQuery('')} className="hover:bg-blue-200 rounded-full p-0.5">
                                                    <Icons.X />
                                                </button>
                                            </span>
                                        )}
                                        {selectedProducts.map(prod => (
                                            <span key={prod} className="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm flex items-center gap-2">
                                                {prod}
                                                <button onClick={() => setSelectedProducts(prev => prev.filter(p => p !== prod))} className="hover:bg-purple-200 rounded-full p-0.5">
                                                    <Icons.X />
                                                </button>
                                            </span>
                                        ))}
                                        {selectedTypes.map(type => (
                                            <span key={type} className="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-sm flex items-center gap-2">
                                                {type}
                                                <button onClick={() => setSelectedTypes(prev => prev.filter(t => t !== type))} className="hover:bg-indigo-200 rounded-full p-0.5">
                                                    <Icons.X />
                                                </button>
                                            </span>
                                        ))}
                                    </div>
                                )}
                            </div>

                            <div className="grid md:grid-cols-2 gap-4">
                                <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <div className="font-semibold mb-2 text-sm text-slate-700">Filter by Product</div>
                                    <div className="flex flex-wrap gap-2">
                                        {allProducts.map(prod => (
                                            <button
                                                key={prod}
                                                onClick={() => {
                                                    setSelectedProducts(prev => 
                                                        prev.includes(prod) 
                                                            ? prev.filter(p => p !== prod)
                                                            : [...prev, prod]
                                                    );
                                                }}
                                                className={`px-3 py-1 rounded-lg text-sm transition-all ${
                                                    selectedProducts.includes(prod)
                                                        ? 'bg-purple-600 text-white'
                                                        : 'bg-slate-100 text-slate-700 hover:bg-slate-200'
                                                }`}
                                            >
                                                {prod}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                                    <div className="font-semibold mb-2 text-sm text-slate-700">Filter by Type</div>
                                    <div className="flex flex-wrap gap-2">
                                        {allTypes.map(type => (
                                            <button
                                                key={type}
                                                onClick={() => {
                                                    setSelectedTypes(prev => 
                                                        prev.includes(type) 
                                                            ? prev.filter(t => t !== type)
                                                            : [...prev, type]
                                                    );
                                                }}
                                                className={`px-3 py-1 rounded-lg text-sm transition-all capitalize ${
                                                    selectedTypes.includes(type)
                                                        ? 'bg-indigo-600 text-white'
                                                        : 'bg-slate-100 text-slate-700 hover:bg-slate-200'
                                                }`}
                                            >
                                                {type}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Products Grid */}
                        <div className="mb-12 fade-in">
                            <h2 className="text-2xl font-bold mb-6 flex items-center gap-2">
                                <Icons.Box /> HOBOT Products
                            </h2>
                            <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4">
                                {[
                                    { name: "Robot Arm", icon: <Icons.Cpu />, color: "bg-indigo-500" },
                                    { name: "Linear Track", icon: <Icons.Settings />, color: "bg-cyan-500" },
                                    { name: "Turn Table", icon: <Icons.History />, color: "bg-blue-500" },
                                    { name: "Reveal Fabric", icon: <Icons.Zap />, color: "bg-purple-500" },
                                    { name: "Stage Mobile", icon: <Icons.Truck />, color: "bg-red-500" },
                                    { name: "Sliding rail", icon: <Icons.Box />, color: "bg-slate-500" },
                                    { name: "Treadmill", icon: <Icons.Target />, color: "bg-emerald-500" },
                                    { name: "Structure Accessory", icon: <Icons.Settings />, color: "bg-orange-500" },
                                ].map((product, idx) => (
                                    <div 
                                        key={idx}
                                        className="bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-all hover:scale-105 text-center"
                                    >
                                        <div className={`w-12 h-12 ${product.color} rounded-lg flex items-center justify-center text-white mx-auto mb-3`}>
                                            {product.icon}
                                        </div>
                                        <div className="text-sm font-semibold text-slate-800 leading-tight">
                                            {product.name}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
                            <div className="lg:col-span-7 space-y-6">
                                <h2 className="text-2xl font-bold flex items-center gap-2 mb-4">
                                    <Icons.Calendar /> Timeline ปี {activeYear}
                                    <span className="text-sm font-normal text-slate-500">
                                        ({workCount} งาน)
                                    </span>
                                    {filteredTimeline.length !== currentTimeline.length && (
                                        <span className="text-sm font-normal text-slate-500">
                                            (แสดง {filteredTimeline.length} จาก {currentTimeline.length})
                                        </span>
                                    )}
                                </h2>
                                
                                {filteredTimeline.length === 0 ? (
                                    <div className="bg-white p-8 rounded-xl shadow-sm border border-slate-200 text-center">
                                        <Icons.Alert className="mx-auto text-slate-400 mb-2" />
                                        <p className="text-slate-500">ไม่พบข้อมูลที่ตรงกับเงื่อนไขการค้นหา</p>
                                    </div>
                                ) : (
                                    <div className="relative border-l-2 border-slate-200 ml-4 pl-8 space-y-8 py-4">
                                        {filteredTimeline.map((item, index) => {
                                            const isExpanded = expandedItems.has(index);
                                            return (
                                                <div key={index} className="relative fade-in slide-in">
                                                    <div className={`absolute -left-[41px] top-1 w-4 h-4 rounded-full border-2 border-white shadow-sm ring-4 ring-slate-50 transition-all ${
                                                        item.type === 'success' ? 'bg-emerald-500' : 
                                                        item.type === 'tech' ? 'bg-blue-500' : 
                                                        item.type === 'milestone' ? 'bg-purple-500' :
                                                        item.type === 'team' ? 'bg-orange-500' :
                                                        'bg-slate-400'
                                                    }`}></div>
                                                    <div 
                                                        className={`bg-white p-5 rounded-xl shadow-sm border transition-all cursor-pointer ${
                                                            item.type === 'success' ? 'border-emerald-200 hover:border-emerald-400' :
                                                            item.type === 'tech' ? 'border-blue-200 hover:border-blue-400' :
                                                            item.type === 'milestone' ? 'border-purple-200 hover:border-purple-400' :
                                                            'border-slate-200 hover:border-blue-300'
                                                        } ${isExpanded ? 'ring-2 ring-blue-200' : ''}`}
                                                        onClick={() => toggleExpanded(index)}
                                                    >
                                                        <div className="flex items-start justify-between">
                                                            <div className="flex-1">
                                                                <div className="flex items-center gap-2 mb-1">
                                                                    <span className="text-xs font-bold text-blue-600 uppercase tracking-wider">{item.month}</span>
                                                                    {item.event.startsWith('งาน ') ? (
                                                                        <span className="text-[10px] px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded font-bold">งาน</span>
                                                                    ) : (
                                                                        <span className="text-[10px] px-2 py-0.5 bg-slate-100 text-slate-600 rounded font-bold">เหตุการณ์</span>
                                                                    )}
                                                                </div>
                                                                <h4 className="font-bold text-lg mb-1">{highlightText(item.event, searchQuery)}</h4>
                                                                <p className="text-slate-600 text-sm mb-3">{highlightText(item.detail, searchQuery)}</p>
                                                                {item.tags && (
                                                                    <div className="flex flex-wrap gap-2 mb-3">
                                                                        {item.tags.map((tag, tIdx) => (
                                                                            <span key={tIdx} className="text-[10px] px-2 py-1 bg-blue-50 text-blue-600 rounded font-bold uppercase">
                                                                                {highlightText(tag, searchQuery)}
                                                                            </span>
                                                                        ))}
                                                                    </div>
                                                                )}
                                                                {isExpanded && item.jobs && (
                                                                    <div className="mt-3 pt-3 border-t border-slate-200 space-y-1">
                                                                        <div className="text-xs font-semibold text-slate-500 mb-2">รายการงาน:</div>
                                                                        {item.jobs.map((job, jIdx) => (
                                                                            <div key={jIdx} className="flex items-center gap-2 text-slate-700 text-sm">
                                                                                <div className="w-1.5 h-1.5 rounded-full bg-blue-500"></div>
                                                                                {highlightText(job, searchQuery)}
                                                                            </div>
                                                                        ))}
                                                                    </div>
                                                                )}
                                                            </div>
                                                            {item.jobs && (
                                                                <button className="ml-2 text-slate-400 hover:text-slate-600 transition-all">
                                                                    {isExpanded ? <Icons.ChevronUp /> : <Icons.ChevronDown />}
                                                                </button>
                                                            )}
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                )}
                            </div>

                            <div className="lg:col-span-5 space-y-8">
                                <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden fade-in">
                                    <div className="bg-slate-900 p-4 text-white font-bold">รายชื่อโปรเจกต์รายเดือน ({activeYear})</div>
                                    <div className="p-2 custom-scrollbar max-h-[500px] overflow-y-auto">
                                        {filteredTimeline.length === 0 ? (
                                            <div className="p-4 text-center text-slate-500 text-sm">ไม่พบข้อมูล</div>
                                        ) : (
                                            <table className="w-full text-sm">
                                                <tbody>
                                                    {filteredTimeline.map((item, idx) => (
                                                        <tr key={idx} className="border-b border-slate-50 last:border-0 hover:bg-slate-50 transition-colors">
                                                            <td className="p-3 align-top font-bold text-blue-600 w-24">{item.month}</td>
                                                            <td className="p-3">
                                                                {item.jobs && item.jobs.map((job, jIdx) => (
                                                                    <div key={jIdx} className="flex items-center gap-2 text-slate-700 mb-1 leading-tight">
                                                                        <div className="w-1 h-1 rounded-full bg-slate-400"></div> 
                                                                        {highlightText(job, searchQuery)}
                                                                    </div>
                                                                ))}
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        )}
                                    </div>
                                </section>

                                {activeYear === 2025 && (
                                    <section className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 fade-in">
                                        <h2 className="text-xl font-bold mb-6 flex items-center gap-2">
                                            <Icons.BarChart /> สรุปการใช้ Product (2025)
                                        </h2>
                                        <div className="space-y-4">
                                            {productStats.map((prod, idx) => (
                                                <div key={idx} className="group cursor-pointer">
                                                    <div className="flex justify-between text-sm mb-1">
                                                        <span className="flex items-center gap-2 font-medium">{prod.icon} {prod.name}</span>
                                                        <span className="font-bold">{prod.count} ครั้ง</span>
                                                    </div>
                                                    <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                                                        <div 
                                                            className={`h-full ${prod.color} transition-all duration-500 group-hover:opacity-80`} 
                                                            style={{ width: `${(prod.count / 6) * 100}%` }}
                                                        ></div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </section>
                                )}
                            </div>
                        </div>
                    </main>
                    
                    <ScrollToTop />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
